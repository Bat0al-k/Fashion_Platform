import{a as $}from"./chunk-5IWPKPXY.js";import{a as D}from"./chunk-W2EITBN7.js";import{$a as M,Ba as R,E as z,F as S,K as g,L as u,U as q,Ua as V,Va as F,W as m,X as k,cb as A,da as f,e as I,fa as d,gb as U,ja as a,ka as o,la as P,oa as T,ob as N,qa as h,ra as l,rb as C,ua as c,va as p,wa as _,y}from"./chunk-CONT6OMZ.js";var J="basil",Z=function(i){return i===3?"v3":i},W="https://js.stripe.com",tt="".concat(W,"/").concat(J,"/stripe.js"),et=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,nt=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,Y="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",rt=function(i){return et.test(i)||nt.test(i)},it=function(){for(var i=document.querySelectorAll('script[src^="'.concat(W,'"]')),t=0;t<i.length;t++){var e=i[t];if(rt(e.src))return e}return null},G=function(i){var t=i&&!i.advancedFraudSignals?"?advancedFraudSignals=false":"",e=document.createElement("script");e.src="".concat(tt).concat(t);var r=document.head||document.body;if(!r)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return r.appendChild(e),e},ot=function(i,t){!i||!i._registerWrapper||i._registerWrapper({name:"stripe-js",version:"7.4.0",startTime:t})},v=null,w=null,O=null,at=function(i){return function(t){i(new Error("Failed to load Stripe.js",{cause:t}))}},ct=function(i,t){return function(){window.Stripe?i(window.Stripe):t(new Error("Stripe.js not available"))}},mt=function(i){return v!==null?v:(v=new Promise(function(t,e){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&i&&console.warn(Y),window.Stripe){t(window.Stripe);return}try{var r=it();if(r&&i)console.warn(Y);else if(!r)r=G(i);else if(r&&O!==null&&w!==null){var s;r.removeEventListener("load",O),r.removeEventListener("error",w),(s=r.parentNode)===null||s===void 0||s.removeChild(r),r=G(i)}O=ct(t,e),w=at(e),r.addEventListener("load",O),r.addEventListener("error",w)}catch(b){e(b);return}}),v.catch(function(t){return v=null,Promise.reject(t)}))},st=function(i,t,e){if(i===null)return null;var r=t[0],s=r.match(/^pk_test/),b=Z(i.version),j=J;s&&b!==j&&console.warn("Stripe.js@".concat(b," was loaded on the page, but @stripe/stripe-js@").concat("7.4.0"," expected Stripe.js@").concat(j,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var L=i.apply(void 0,t);return ot(L,e),L},x,B=!1,X=function(){return x||(x=mt(null).catch(function(i){return x=null,Promise.reject(i)}),x)};Promise.resolve().then(function(){return X()}).catch(function(n){B||console.warn(n)});var H=function(){for(var i=arguments.length,t=new Array(i),e=0;e<i;e++)t[e]=arguments[e];B=!0;var r=Date.now();return X().then(function(s){return st(s,t,r)})};function dt(n,i){n&1&&(a(0,"div",7),P(1,"div",8),a(2,"p"),c(3,"Loading your cart..."),o()())}function lt(n,i){if(n&1&&(a(0,"div",9),c(1),o()),n&2){let t=l();m(),_(" ",t.errorMessage," ")}}function pt(n,i){n&1&&(a(0,"div",10)(1,"div",11),c(2,"\u{1F6D2}"),o(),a(3,"h2"),c(4,"Your cart is empty"),o(),a(5,"p"),c(6,"Looks like you haven't added any items to your cart yet."),o(),a(7,"button",12),c(8,"Continue Shopping"),o()())}function gt(n,i){if(n&1&&(a(0,"div",43),c(1),o()),n&2){let t=l().$implicit;m(),_(" Color: ",t.color," ")}}function ut(n,i){if(n&1){let t=T();a(0,"div",27)(1,"div",28),P(2,"img",29),o(),a(3,"div",30)(4,"h3",31),c(5),o(),f(6,gt,2,1,"div",32),a(7,"div",33),c(8),o()(),a(9,"div",34)(10,"label"),c(11,"Quantity:"),o(),a(12,"div",35)(13,"button",36),h("click",function(){let r=g(t).$implicit,s=l(2);return u(s.updateQuantity(r._id,r.quantity-1))}),c(14,"-"),o(),a(15,"span",37),c(16),o(),a(17,"button",38),h("click",function(){let r=g(t).$implicit,s=l(2);return u(s.updateQuantity(r._id,r.quantity+1))}),c(18,"+"),o()()(),a(19,"div",39)(20,"div",40),c(21),o()(),a(22,"div",41)(23,"button",42),h("click",function(){let r=g(t).$implicit,s=l(2);return u(s.removeItem(r._id))}),c(24,"\u2715"),o()()()}if(n&2){let t=i.$implicit,e=l(2);m(2),d("src",t.image,q)("alt",t.name),m(3),p(t.name),m(),d("ngIf",t.color),m(2),p(e.formatPrice(t.price)),m(5),d("disabled",t.quantity<=1),m(3),p(t.quantity),m(5),p(e.formatPrice(e.getItemTotal(t)))}}function ft(n,i){if(n&1&&(a(0,"span"),c(1),o()),n&2){let t=l(2);m(),p(t.formatPrice(t.getShipping()))}}function ht(n,i){n&1&&(a(0,"span",44),c(1,"FREE"),o())}function _t(n,i){if(n&1&&(a(0,"div",45)(1,"p"),c(2),o()()),n&2){let t=l(2);m(2),_("Add ",t.formatPrice(100-t.getSubtotal())," more for FREE shipping!")}}function Ct(n,i){if(n&1){let t=T();a(0,"div",13)(1,"div",14)(2,"div",15)(3,"h2"),c(4),o(),a(5,"button",16),h("click",function(){g(t);let r=l();return u(r.clearCart())}),c(6,"Clear Cart"),o()(),f(7,ut,25,8,"div",17),o(),a(8,"div",18)(9,"h3"),c(10,"Order Summary"),o(),a(11,"div",19)(12,"span"),c(13),o(),a(14,"span"),c(15),o()(),a(16,"div",19)(17,"span"),c(18,"Tax (10%):"),o(),a(19,"span"),c(20),o()(),a(21,"div",19)(22,"span"),c(23,"Shipping:"),o(),f(24,ft,2,1,"span",20)(25,ht,2,0,"span",21),o(),P(26,"div",22),a(27,"div",23)(28,"span"),c(29,"Total:"),o(),a(30,"span"),c(31),o()(),f(32,_t,3,1,"div",24),a(33,"div",25)(34,"button",26),h("click",function(){g(t);let r=l();return u(r.onCheckout())}),c(35," Proceed to Checkout "),o(),a(36,"button",12),c(37," Continue Shopping "),o()()()()}if(n&2){let t=l();m(4),_("Cart Items (",t.getCartItemCount(),")"),m(3),d("ngForOf",t.cartItems),m(6),_("Subtotal (",t.getCartItemCount()," items):"),m(2),p(t.formatPrice(t.getSubtotal())),m(5),p(t.formatPrice(t.getTax())),m(4),d("ngIf",t.getShipping()>0),m(),d("ngIf",t.getShipping()===0),m(6),p(t.formatPrice(t.getTotal())),m(),d("ngIf",t.getSubtotal()<100),m(2),d("disabled",t.isCartEmpty())}}var E=(()=>{class n{constructor(t,e){this.cartService=t,this.http=e,this.cartItems=[],this.isLoading=!0,this.errorMessage=""}ngOnInit(){this.loadCart()}loadCart(){this.isLoading=!0,this.cartService.getCart().subscribe({next:t=>{console.log("Cart loaded:",t),t&&Array.isArray(t.items)?this.cartItems=t.items:t&&typeof t=="object"&&"items"in t?this.cartItems=Array.isArray(t.items)?t.items:[]:(console.error("Invalid cart format:",t),this.cartItems=[]),this.isLoading=!1},error:t=>{console.error("Error loading cart:",t),this.errorMessage="Failed to load cart",this.isLoading=!1,this.cartItems=[]}})}updateQuantity(t,e){e<1&&(e=1),this.cartService.updateCartItem(t,e).subscribe({next:r=>{console.log("Cart item updated:",r),this.loadCart()},error:r=>{console.error("Error updating cart item:",r)}})}removeItem(t){this.cartService.removeFromCart(t).subscribe({next:e=>{console.log("Item removed from cart:",e),this.loadCart()},error:e=>{console.error("Error removing item from cart:",e)}})}clearCart(){this.cartService.clearCart().subscribe({next:t=>{console.log("Cart cleared:",t),this.loadCart()},error:t=>{console.error("Error clearing cart:",t)}})}getSubtotal(){return this.cartItems.reduce((t,e)=>t+e.price*e.quantity,0)}getTax(){return this.getSubtotal()*.1}getShipping(){return this.getSubtotal()>100?0:10}getTotal(){return this.getSubtotal()+this.getTax()+this.getShipping()}formatPrice(t){return`$${t.toFixed(2)}`}getItemTotal(t){return t.price*t.quantity}getCartItemCount(){return this.cartItems.reduce((t,e)=>t+e.quantity,0)}isCartEmpty(){return this.cartItems.length===0}checkout(){return I(this,null,function*(){let t=yield H($.STRIPE_PUBLIC_KEY),e=this.cartItems.map(s=>({quantity:s.quantity,price:s.price,name:s.name})),r=sessionStorage.getItem("token");this.http.post("http://localhost:3000/api/checkout/create-checkout-session",{products:e},{headers:{Authorization:` Bearer ${r}`}}).subscribe({next:s=>I(this,null,function*(){s.url?window.location.href=s.url:console.error("No URL returned from Stripe")}),error:s=>{console.error("Checkout error:",s)}})})}onCheckout(){this.checkout()}static{this.\u0275fac=function(e){return new(e||n)(k(D),k(A))}}static{this.\u0275cmp=z({type:n,selectors:[["app-cart"]],standalone:!0,features:[R],decls:11,vars:4,consts:[[1,"cart-container"],[1,"container"],[1,"page-header"],["class","loading",4,"ngIf"],["class","error-message",4,"ngIf"],["class","empty-cart",4,"ngIf"],["class","cart-content",4,"ngIf"],[1,"loading"],[1,"spinner"],[1,"error-message"],[1,"empty-cart"],[1,"empty-cart-icon"],["routerLink","/products",1,"continue-shopping-btn"],[1,"cart-content"],[1,"cart-items"],[1,"cart-header"],[1,"clear-cart-btn",3,"click"],["class","cart-item",4,"ngFor","ngForOf"],[1,"cart-summary"],[1,"summary-item"],[4,"ngIf"],["class","free-shipping",4,"ngIf"],[1,"summary-divider"],[1,"summary-total"],["class","shipping-info",4,"ngIf"],[1,"checkout-actions"],[1,"checkout-btn",3,"click","disabled"],[1,"cart-item"],[1,"item-image"],[3,"src","alt"],[1,"item-details"],[1,"item-name"],["class","item-color",4,"ngIf"],[1,"item-price"],[1,"item-quantity"],[1,"quantity-controls"],[1,"quantity-btn",3,"click","disabled"],[1,"quantity-value"],[1,"quantity-btn",3,"click"],[1,"item-total"],[1,"total-price"],[1,"item-actions"],["title","Remove item",1,"remove-btn",3,"click"],[1,"item-color"],[1,"free-shipping"],[1,"shipping-info"]],template:function(e,r){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),c(4,"Shopping Cart"),o(),a(5,"p"),c(6,"Review your items and proceed to checkout"),o()(),f(7,dt,4,0,"div",3)(8,lt,2,1,"div",4)(9,pt,9,0,"div",5)(10,Ct,38,10,"div",6),o()()),e&2&&(m(7),d("ngIf",r.isLoading),m(),d("ngIf",r.errorMessage),m(),d("ngIf",!r.isLoading&&!r.errorMessage&&r.isCartEmpty()),m(),d("ngIf",!r.isLoading&&!r.errorMessage&&!r.isCartEmpty()))},dependencies:[M,V,F,C,N,U],styles:[".cart-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(120deg,#fdfbfb,#ebedee);padding:4rem 0}.container[_ngcontent-%COMP%]{max-width:1240px;margin:0 auto;padding:0 2rem}.page-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:4rem;padding:2rem;background:#fff;border-radius:1.25rem;box-shadow:0 8px 30px #00000014}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;color:#2d3748;margin-bottom:.5rem;font-weight:800}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#718096;font-size:1.125rem;max-width:600px;margin:0 auto}.loading[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:#fff;border-radius:1.25rem;margin:1rem 0;box-shadow:0 4px 16px #0000000a}.spinner[_ngcontent-%COMP%]{border:6px solid #e2e8f0;border-top:6px solid #4299e1;border-radius:50%;width:3rem;height:3rem;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1.5rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-message[_ngcontent-%COMP%]{text-align:center;color:#e53e3e;padding:1.5rem;background:#fff5f5;border-radius:1rem;margin:1.5rem 0;font-size:1rem;font-weight:600}.empty-cart[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;background:#fff;border-radius:1rem;box-shadow:0 4px 20px #0000000d;margin:1rem 0}.empty-cart-icon[_ngcontent-%COMP%]{font-size:3.5rem;margin-bottom:1.5rem;color:#4299e1}.empty-cart[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem;color:#2d3748;margin-bottom:.75rem}.empty-cart[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#4a5568;margin-bottom:2rem;font-size:1rem}.continue-shopping-btn[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;padding:.75rem 2rem;border-radius:.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:.3s ease}.continue-shopping-btn[_ngcontent-%COMP%]:hover{background-color:#b12b2b;transform:translateY(-2px);box-shadow:0 6px 14px #0000001a}.cart-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:3fr 1fr;gap:2.5rem;margin:2rem 0}.cart-items[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2.5rem;box-shadow:0 8px 24px #0000000f}.cart-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid #e2e8f0}.cart-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;color:#2d3748;font-weight:700}.clear-cart-btn[_ngcontent-%COMP%]{background:#e53e3e;color:#fff;border:none;padding:.5rem 1.5rem;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:.3s ease}.clear-cart-btn[_ngcontent-%COMP%]:hover{background:#c53030;transform:translateY(-2px)}.cart-item[_ngcontent-%COMP%]{display:flex;gap:1.5rem;padding:1.5rem;margin-bottom:1.5rem;background:#f7fafc;border-radius:1rem;box-shadow:0 4px 16px #0000000a;align-items:center;transition:.3s ease}.cart-item[_ngcontent-%COMP%]:hover{background:#edf2f7;transform:translateY(-4px)}.item-image[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:.75rem;overflow:hidden;border:1px solid #cbd5e0}.item-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.item-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.item-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;color:#2d3748}.item-color[_ngcontent-%COMP%]{color:#718096;font-size:.875rem}.item-price[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:#3182ce}.item-quantity[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;align-items:center}.item-quantity[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:#4a5568;font-weight:500}.quantity-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;background:#e2e8f0;padding:.25rem;border-radius:.5rem}.quantity-btn[_ngcontent-%COMP%]{width:2rem;height:2rem;border:none;background:#fff;border-radius:.375rem;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 6px #0000000f}.quantity-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#3182ce;color:#fff}.quantity-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.quantity-value[_ngcontent-%COMP%]{font-weight:600;color:#2d3748;min-width:2rem;text-align:center}.item-total[_ngcontent-%COMP%]{text-align:center;font-weight:700;color:#1a202c}.total-price[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:700;color:#1a202c}.item-actions[_ngcontent-%COMP%]{display:flex;justify-content:center}.remove-btn[_ngcontent-%COMP%]{width:2rem;height:2rem;border:none;background:#fff0f0;color:#e53e3e;border-radius:.5rem;font-size:.875rem;font-weight:600;cursor:pointer;transition:.3s ease;display:flex;align-items:center;justify-content:center}.remove-btn[_ngcontent-%COMP%]:hover{background:#e53e3e;color:#fff}.cart-summary[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 8px 24px #0000000f;height:fit-content;position:sticky;top:1.5rem}.cart-summary[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem;color:#2d3748;margin-bottom:1.5rem;font-weight:700}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:1rem;font-size:.875rem;color:#4a5568}.summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{font-weight:600;color:#1a202c}.free-shipping[_ngcontent-%COMP%]{color:#38a169!important;font-weight:700}.summary-divider[_ngcontent-%COMP%]{height:1px;background:#e2e8f0;margin:1.5rem 0}.summary-total[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:1.125rem;font-weight:700;color:#1a202c;margin-bottom:1.5rem}.shipping-info[_ngcontent-%COMP%]{background:#e6fffa;color:#2c7a7b;padding:.75rem;border-radius:.5rem;font-size:.875rem;text-align:center;margin-bottom:1.5rem}.checkout-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.checkout-btn[_ngcontent-%COMP%]{background:#38a169;color:#fff;border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-size:1rem;font-weight:600;cursor:pointer;transition:.3s ease}.checkout-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#2f855a;transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.checkout-btn[_ngcontent-%COMP%]:disabled{background:#e2e8f0;cursor:not-allowed}.login-prompt[_ngcontent-%COMP%]{text-align:center;padding:1rem;background:#fffbea;border:1px solid #fefcbf;border-radius:.5rem;color:#744210;font-size:.875rem}.login-prompt[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#4299e1;text-decoration:none;font-weight:600}.login-prompt[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}@media (max-width: 1024px){.cart-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.cart-summary[_ngcontent-%COMP%]{position:static}}@media (max-width: 768px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.cart-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.item-image[_ngcontent-%COMP%]{margin-bottom:1rem}.item-quantity[_ngcontent-%COMP%]{flex-direction:row;justify-content:flex-start}.cart-items[_ngcontent-%COMP%], .cart-summary[_ngcontent-%COMP%]{padding:1.5rem}}"]})}}return n})();var vt=[{path:"",component:E,pathMatch:"full"}],Q=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275mod=S({type:n})}static{this.\u0275inj=y({imports:[C.forChild(vt),C]})}}return n})();var Ut=(()=>{class n{static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275mod=S({type:n})}static{this.\u0275inj=y({imports:[M,Q,E]})}}return n})();export{Ut as CartModule};
